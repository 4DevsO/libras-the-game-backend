<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <title>O JOGO</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  </head>
  <body>
    <div>
      <h3>CONFIGURACOES</h3>
      <br />
      <label>nome</label> <input id="config-add-nome" type="text" /><br />
      <label>imagem</label> <input id="config-add-img" type="file" /><br />
      <button onclick="saveConfig()">SALVAR CONFIGURACAO</button><br />
      <p id="config-add-res"></p>
      <br />
    </div>
    <div>
      <br />
      <br />
      <h3>PALAVRAS</h3>
      <br />
      <label>nome</label> <input id="palavra-add-nome" type="text" /><br />
      <label>configuracoes</label> <input id="palavra-add-config" /><br />
      <button onclick="savePalavra()">SALVAR PALAVRA</button>
      <p id="palavra-add-res"></p>
    </div>
  </body>
</html>
<script>
  const savePalavra = () => {
    const nome_input = document.getElementById("palavra-add-nome");
    const palavra_input = document.getElementById("palavra-add-config");
    const p_out = document.getElementById("palavra-add-res");
    const settings = {
      async: false,
      crossDomain: true,
      processData: false,
      contentType: false,
      type: "POST",
      url: "https://libras-o-jogo.herokuapp.com/palavras/add",
      contentType: "application/json"
    };
  };
  const saveConfig = () => {
    const img_input = document.getElementById("config-add-img");
    const nome_input = document.getElementById("config-add-nome");
    const p_out = document.getElementById("config-add-res");
    if (img_input.value && nome_input.value) {
      const img = img_input.files[0];
      const headers = {
        Authorization: "Client-ID f33f400641ab02a",
        Accept: "application/json"
      };
      const settings = {
        async: false,
        crossDomain: true,
        processData: false,
        contentType: false,
        type: "POST",
        url: "https://api.imgur.com/3/image",
        headers: headers,
        mimeType: "multipart/form-data"
      };
      const formdata = new FormData();
      formdata.append("image", img);
      settings.data = formdata;
      $.ajax(settings).done(response => {
        response = JSON.parse(response);
        const settings2 = {
          async: false,
          crossDomain: true,
          processData: false,
          contentType: false,
          type: "POST",
          url: "https://libras-o-jogo.herokuapp.com/configuracoes/add",
          contentType: "application/json",
          data: {
            configuracao: { nome: nome_input.value, imagem: response.data.link }
          }
        };
        $.ajax(settings2).done(result => {
          p_out.innerText = result;
        });
      });
    } else {
      p_out.innerText = "ALGUM CAMPO EM BRANCO...";
    }
  };
</script>
